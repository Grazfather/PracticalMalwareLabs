# Lab 18
The goal for these labs is simply to unpack the code so that we could proceed with further analysis.

## Lab 18-1
### Basic Static Analysis
- **strings**: Nothing interesting other than some alphabets and imports.
- **PEiD**: Nothing found *
- **Dependency Walker**: `URLDownloadCacheFileA` from _URLMON.DLL_, `GetUserNameA` from _ADVAPI32.DLL_, `ExitProcess`, `GetProcAddress`, `LoadLibraryA`, `VirtualAlloc`, `VirtualFree`, and `VirtualProtect` from _KERNEL32.DLL_.
- **PEview**: .text, .data, and "UPX2" which suggests it's packed with UPX. Entrypoint is 0x9DC0. With .data's RVA of 0x7000 and size of 0x3000 it falls within there.

### Advanced Static Analysis
IDA only recognizes a single function, `start`. Looking for `jmp` instructions, one in particular stands out: `jmp byte_40154F` at 0x409F43. It's both a long jump, and its target doesn't contain valid instructions.

Setting a bp on this address and then making a single step (avoiding setting a SW breakpoint on code that is changing) indeed hits and goes to what is now normal looking code. Using OllyDump with the default settings I was able to dump the process memory into an executable for analysis in IDA. Looking at the now visible strings, I found "http://www.practicalmalwareanalysis.com/%s/%c.png". Grepping for that in my other writeups, I see that the same string was used in Lab 14-1, and can easily verify that they are the same malware.
