# Chapter 6 labs
## Lab 6-1
### Basic Static Analysis
- strings: We see normal imports/imports (not packed) and an error message and success message "Error 1.1: No Internet", and "Success: Internet Connection".
- PEiD: Unpacked, Microsoft Visual C++ 6.0
- Dependency Walker: Imports 'InternetGetConnectedState' from WININET.DLL as well as a bunch from KERNEL32.DLL but nothing out of the ordinary.
- PEview: Normal section names and headers.

### Basic Dynamic Analysis
Because the malware didn't import any functions to make internet connections I didn't bother with Wireshark or fakedns.py and just ran it. Procmon doesn't show anything interesting, and all we see in the shell is that it prints the success string from above.

### Advanced Static Analysis
Loaded into IDA we see a very simple main function that calls into sub_401000. Viewing this function in graph view easily shows it's an if/else statement, and we can see the addresses pushed on the stack before calling sub_40105F are strings.

### Questions
1. sub_401000 contains a simple if/else block that tests the result of 'InternetGetConntectedState'.
2. sub_40105F is called from both cases of the if/else block in sub_401000 and is passed a pointer to a success/failure string. Since we know these strings can get printed to the shell (from running the application) we can surmise that this function is something analogous to printf.
3. It appears this program does nothing more than check if the system has an internet connection and print a success/failure message.
