# Chapter 3 labs
## Lab 3-1

1. According to PEid it is packed/encrypted using "PEncrypt 3.1 Final -> junkcode". There are a bunch of readable strings: A few registry keys and application names. PEview only shows two sections: Text and Data, and only one import: ExitProcess from kernel32.dll.
2. I couldn't get AbateDNS to work so I used a python script (https://github.com/Crypt0s/FakeDns) to respond to all DNS requests with localhost as the address. I then set up netcat to listen on ports 80 and 443 (http and https) as suggested by the book and set up Wireshark to listen in on all traffic. Finally, I opened process explorer and procmon to see what the malware was trying to do. When I executed the malware you can see that the process is creating a new file (probably a copy of itself) to C:\Windows\system32\vmx32to64.exe and it then wrote this path to the registry to autorun (HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/Run/VideoDriver). Viewing 'handles' in procmon we see it creates a mutex (mutant) named WinVMX32.
3. fakedns.py reports a periodic dns request to "www.practicalmalwareanalysis.com" and (after spoofing) connects to my netcat listening on port 443 (https). The data we receive does not look like the start of a https transfer, though, and changes every time it makes a connection. Wireshark seemed to only pick up 'raw' tcp data and it was hard to distinguish from other data. It didn't appear to have anything going localhost->localhost.

