# Chapter 1 labs
## Lab 1-1
1. **exe**: Runs clean for most, but found as trojan/Malware by Avast, Symantec, GData, Ikarus and AntiVir.
   **dll**: Runs clean for most, but found as 'W32/GenBl.290934C6!Olympus' by Commtouch
2. **exe**: 2010/12/19 Sun 16:16:19 UTC
   **dll**: 2010/12/19 Sun 16:16:38 UTB
3. **exe**: No (We can see many imports)
   **dll**: No (We can see many imports)
4. dll imports `CreateProcessA` and some networking related things. Network imports are by ordinal for some reason.
5. Running strings on the dll and exe yields an IP as well as a reference to kernel132.dll (as opposed to kerneL32.dll) which may be another malicious dll.
6. What ports it connects to, the protocol it uses, the IP is tries to connect to, etc.
7. A backdoor installer

## Lab 1-2
1. About half of the AV find an issue. Most tag it as a downloader/generic.
2. Yes. Section names are non standard (but UPX standard) and it imports `LoadLibraryA`. We can unpack with upx.
3. `CreateServiceA` and `InternetOpenA`.
4. There is a reference to "MalService" and "Malservice" as well as "malwareanalysisbook.com", combined with it importing `CreateService` we should check for a service named MalService.

## Lab 1-3
1. Most detect a virus and that it's packed.
2. Definitely packed: Unnamed sections and few imports (Only `GetProcAddress` and `LoadLibraryA`). Cannot unpack yet as we do not know how to unpack 'FSG 1.0 -> dulek/xt'.
3. Cannot unpack so we cannot see real imports.
4. The only real strings we see are for the few imports. We need to unpack this to get more information.

## Lab 1-4
1. Most detect a virus: Generic, Trojan, or Downloader
2. Doesn't look packed, as the imports are clearly visible, and the virtual size is close to the size on disk.
3. 2019/08/30 Fri 22:26:59 UTC. In the future, so clearly not accurate.
4. `AdjustTokenPrivileges`, `LookupPrivilegeValueA`, `OpenProcessToken`, a lot of process/resource related imports. Might try to change file permissions, or download new files.
5. Running strings we see a reference to "http://www.practicalmalwareanalysis.com/updater.exe" which it probably downloads and executes to keep itself up to date.
6. It only has one resource which seems to be a second PE (with a bit of a header). Saving this and converting the hexdump into the original binary allows we to re-run the analysis tools. (I also could have just saved it as a binary from Resource Hacker). This new binary imports things like `URLDownloadToFileA` and `WinExec` suggesting it downloads the updater and then executes it.
